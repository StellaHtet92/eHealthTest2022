<?php
/*
* Database Constants
* Make sure you are putting the values according to your database here
*/
define('DB_HOST','localhost');
define('DB_USERNAME','root');
define('DB_PASSWORD','');
define('DB_NAME', 'his');
//Connecting to the database
$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);
//checking the successful connection
if($conn->connect_error) {
die("Connection failed: " . $conn->connect_error);
}
//making an array to store the response
$response = array();
//if there is a post request move ahead
if($_SERVER['REQUEST_METHOD']=='POST'){
//getting the ecg data from request

$user_id = $_POST['user_id'];
//$vital_id = $_POST['vital_id'];
$ecg = $_POST['ecg'];
$dateString=$_POST['createdAt'];
$createdAt = \DateTime::createFromFormat('Y-m-d H:i:s', $dateString);
$createdAt=$createdAt ->format('Y-m-d H:i:s');


/*
$user_id = "1";
$vital_id ="1";
$ecg = "689274,E4095
689277,E4095
689278,E4095
689279,E4095
689280,E4095
689281,E4095
689282,E2571
689283,E53
689285,E0
689286,E0
689287,E0
689288,E0
689289,E0
689290,E0
689291,E0
689292,E968
689293,E3706
689294,E4095
689295,E4095
689296,E4095
689297,E4095
689298,E4086
689299,E4095
689300,E4095
689301,E4095
689302,E2526
689303,E256
689304,E0
689305,E0
689306,E0
689307,E0
689308,E0
689309,E0
689310,E0
689311,E0
689312,E944
689313,E3674
689314,E4095
689315,E4095
689316,E4095
689317,E4095
689318,E4070
689319,E4095
689320,E4095
689321,E4095
689322,E2541
689323,E377
689324,E0
689325,E0
689326,E0
689327,E0
689328,E0
689329,E0
689330,E0
689331,E0
689332,E915
689333,E3669
689334,E4095
689335,E4095
689336,E4095
689337,E4095
689338,E4095
689339,E4095
689340,E4095
689341,E4095
689342,E1963
689344,E0
689345,E0
689346,E0
689347,E0
689348,E0
689349,E0
689350,E0
689351,E0
689352,E917
689353,E3504
689354,E4095
689355,E4095
689356,E4095
689357,E4095
689358,E4095
689359,E4095
689360,E4095
689361,E4095
689362,E2409
689363,E81
689364,E0
689365,E0
689366,E0
689367,E0
689368,E0
689369,E0
689370,E0
689371,E0
689372,E975
689373,E3741
689374,E4095
689375,E4095
689376,E4095
689377,E4095
689378,E4095
689379,E4095
689380,E4095
689381,E4095
689382,E2373
689383,E80
689384,E0
689385,E0
689386,E0
689387,E0
689388,E0
689389,E0
689390,E0
689391,E0
689392,E1044
689393,E3843
689394,E4095
689395,E4095
689396,E4095
689397,E4095
689398,E4095
689399,E4095
689400,E4095
689401,E4095
689402,E2001
689403,E0
689404,E0
689405,E0
689406,E0
689407,E0
689408,E0
689409,E0
689410,E0
689411,E0
689412,E1037
689413,E3805
689414,E4095
689415,E1811
689533,E4095
689534,E4095
689535,E4095
689536,E4095
689537,E4095
689538,E4095
689539,E4095
689540,E4095
689541,E4095
689542,E2370
689543,E71
689544,E0
689545,E0
689546,E0
689566,E0
689567,E0
689568,E0
689569,E0
689570,E0
689571,E0
689572,E1321
689573,E4087
689574,E4095
689575,E4095
689576,E4095
689577,E4095
689578,E4095
689579,E4095
689580,E4095
689581,E4095
689582,E2033
689583,E0
689584,E0
689585,E0
689586,E0
689587,E0
689588,E0
689589,E0
689590,E0
689591,E0
689592,E471
689633,E4095
689634,E4095
689635,E4095
689636,E4095
689637,E4095
689638,E4095
689639,E4095
689640,E4095
689641,E4095
689642,E2074
689643,E0
689644,E0
689645,E0
689665,E0
689666,E0
689667,E0
689668,E0
689669,E0
689670,E0
689671,E41
689672,E1933
689673,E4095
689674,E4095
689675,E4095
689676,E4095
689677,E4095
689699,E4095
689700,E4095
689701,E4095
689702,E2288
689703,E159
689704,E0
689705,E0
689706,E0
689707,E0
689708,E0
689709,E0
689710,E0
689711,E215
689712,E2242
689713,E4095
689714,E4095
689715,E4095
689716,E4095
689717,E4095
689718,E4095
689719,E4095
689720,E4095
689721,E4095
689722,E2171
689723,E0
689724,E0
689725,E0
689726,E0
689729,E0
689730,E0
689731,E71
689732,E1969
689733,E4080
689734,E4095
689735,E4095
689736,E4095
689737,E4095
689738,E4095
689739,E4095
689740,E4095
689741,E4095
689742,E2027
689743,E0
689744,E0
689745,E0
689746,E0
689747,E0
689748,E0
689749,E0
689750,E0
689751,E0
689752,E1803
689753,E4095
689754,E4095
689755,E4095
689756,E4095
689757,E4095
689758,E4095
689759,E4095
689760,E4095
689761,E3985
689762,E1819
689763,E0
689764,E0
689765,E0
689766,E0
689767,E0
689768,E0
689769,E0
689770,E0
689771,E0
689772,E1861
689773,E4080
689774,E4095
689775,E4095
689776,E4095
689777,E4095
689778,E4080
689779,E4095
689780,E4095
689781,E4006
689782,E1827
689783,E0
689784,E0
689785,E0
689786,E0
689787,E0
689788,E0
689789,E0
689790,E0
689791,E99
689792,E2018
689793,E4095
689794,E4095
689795,E4095
689796,E4095
689797,E4095
689798,E4095
689799,E4095
689800,E4095
689801,E4006
689802,E1831
689803,E0
689804,E0
689805,E0
689806,E0
689807,E0
689808,E0
689809,E0
689810,E0
689811,E60
689812,E2019
689813,E4095
689814,E4095
689815,E4095
689816,E4095
689817,E4095
689818,E4095
689819,E4095
689820,E4095
689821,E3871
689822,E1771
689823,E0
689824,E0
689825,E0
689826,E0
689827,E0
689828,E0
689829,E0
689830,E0
689831,E101
689832,E2007
689833,E4095
689834,E4095
689835,E4095
689836,E4095
689837,E4095
689838,E4095
689839,E4095
689840,E4095
689841,E3824
689842,E1755
689843,E0
689844,E0
689845,E0
689846,E0
689847,E0
689848,E0
689849,E0
689850,E0
689851,E184
689852,E2205
689853,E4095
689854,E4095
689855,E4095
689856,E4095
689857,E4095
689858,E4095
689859,E4095
689860,E4095
689861,E3893
689862,E1778
689863,E0
689864,E0
689865,E0
689866,E0
689867,E0
689868,E0
689869,E0
689870,E0
689871,E176
689872,E2205
689873,E4095
689874,E4095
689875,E4095
689876,E4095
689877,E4095
689878,E4095
689879,E4095
689880,E4095
689881,E3845
689882,E1702
689883,E0
689884,E0
689885,E0
689886,E0
689887,E0
689888,E0
689889,E0
689890,E0
689891,E264
689892,E2335
689893,E4095
689894,E4095
689895,E4095
689896,E4095
689897,E4095
689898,E4095
689899,E4095
689900,E4095
689901,E3759
689902,E1605
689903,E0
689904,E0
689905,E0
689906,E0
689907,E0
689908,E0
689909,E0
689910,E0
689911,E255
689912,E2351
689913,E4095
689914,E4095
689915,E4095
689916,E4095
689917,E4095
689918,E4095
689919,E4095
689920,E4095
689921,E3775
689922,E1681
689923,E0
689924,E0
689925,E0
689926,E0
689927,E0
689928,E0
689929,E0
689930,E0
689931,E223
689932,E2292
689933,E4073
689934,E4095
689935,E4095
689936,E4095
689937,E4095
689938,E4095
689939,E4095
689940,E4095
689941,E3807
689942,E1693
689943,E0
689944,E0
689945,E0
689946,E0
689947,E0
689948,E0
689949,E0
689950,E0
689951,E427
689952,E2603
689953,E4080
689954,E4095
689955,E4095
689956,E4095
689957,E4095
689958,E4095
689959,E4095
689960,E4095
689961,E3858
689962,E1765
689963,E0
689964,E0
689965,E0
689966,E0
689967,E0
689968,E0
689969,E0
689970,E0
689971,E545
689972,E2816
689973,E4095
689974,E4095
689975,E4095
689976,E4095
689977,E4095
689978,E4081
689979,E4095
689980,E4095
689981,E3790
689982,E1694
689983,E0
689984,E0
689985,E0
689986,E0
689987,E0
689988,E0
689989,E0
689990,E0
689991,E352
689992,E2518
689993,E4095
689994,E4095
689995,E4095
689996,E4095
689997,E4095
689998,E4095
689999,E4095
690000,E4095
690001,E3843
690002,E1738
690003,E0
690004,E0
690005,E0
690006,E0
690007,E0
690008,E0
690009,E0
690010,E0
690011,E442
690012,E2669
690013,E4095
690014,E4095
690015,E4095
690016,E4095
690017,E4095
690018,E4095
690019,E4095
690020,E4095
690021,E3603
690022,E1501
690023,E0
690024,E0
690025,E0
690026,E0
690027,E0
690028,E0
690029,E0
690030,E0
690031,E533
690032,E2782
690033,E4081
690034,E4095
690035,E4095
690036,E4095
690037,E4095
690038,E4095
690039,E4095
690040,E4095
690041,E3818
690042,E1619
690043,E0
690044,E0
690045,E0
690046,E0
690047,E0
690048,E0
690049,E0
690050,E0
690051,E605
690052,E2928
690053,E4095
690054,E4095
690055,E4095
690056,E4095
690057,E4095
690058,E4095
690059,E4095
690060,E4095
690061,E4095
690077,E4095
690078,E4095
690079,E4095
690080,E4095
690081,E3711
690082,E1522
690083,E0
690084,E0
690085,E0
690086,E0
690087,E0
690088,E0
690089,E0
690090,E0
690091,E566
690092,E2839
690093,E4095
690094,E4095
690095,E4095
690096,E4095
690097,E4095
690098,E4095
690099,E4095
690100,E4095
690101,E3643
690102,E1486
690103,E0
690104,E0
690107,E0
690108,E0
690109,E0
690110,E0
690111,E438
690112,E2645
690113,E4095
690114,E4095
690115,E4095
690116,E4095
690117,E4095
690118,E4095
690119,E4095
690120,E4095
690121,E3152
690122,E1050
690123,E0
690124,E0
690125,E0
690126,E0
690127,E0
690128,E0
690129,E0
690130,E0
690131,E440
690132,E2695
690133,E4091
690134,E4095
690135,E4095
690136,E4095
690137,E4095
690138,E4086
690139,E4095
690140,E4095
690141,E3248
690142,E1170
690143,E0
690144,E0
690145,E0
690146,E0
690147,E0
690148,E0
690149,E0
690150,E0
690151,E0
691145,E0
691146,E0
691147,E0
691148,E0
691149,E0
691150,E57
691151,E0
692145,E0
692146,E0
692147,E0
692148,E0
692149,E0
692150,E1815
692151,E0
692368,E0
692369,E170
692370,E2087
692371,E4095
692372,E4095
692373,E4095
692374,E4095
692375,E4095
692376,E4095
692377,E4095
692378,E4095
692379,E3185
692380,E1238
692381,E0
692382,E0
692383,E0
692384,E0
692385,E0
692386,E0
692387,E0
692388,E0
692389,E185
692390,E2225
692391,E4095
692392,E4095
692393,E4095
692394,E4095
692395,E4095
692396,E4095
692397,E4095
692398,E4095
692399,E3405
692400,E1379
692401,E0
692402,E0
692405,E0
692406,E0
692407,E0
692408,E0
692409,E151
692410,E2101
692411,E4095
692412,E4095
692413,E4095
692414,E4095
692415,E4095
692416,E4095
692417,E4095
692418,E4095
692419,E3148
692420,E983
692421,E0
692422,E0
692423,E0
692424,E0
692425,E0
692426,E0
692427,E0
692428,E0
692429,E119
692430,E2122
692431,E4095
692499,E3554
692500,E1557
692501,E0
692502,E0
692503,E0
692504,E0
692505,E0
692506,E0
692507,E0
692508,E0
692509,E544
692510,E2843
692511,E3509
692631,E4095
692632,E4095
692633,E4074
692634,E4095
692635,E4095
692636,E4095
692637,E4095
692638,E4090
692639,E3055
692640,E897
692641,E0
692642,E0
692643,E0
692644,E0
692645,E0
692646,E0
692647,E0
692648,E0
692649,E763
692650,E3162
692651,E4095
692652,E4095
692653,E4081
692654,E4095
692655,E4095
692656,E4095
692657,E4095
692658,E4066
692659,E2915
692660,E833
692661,E0
692662,E0
692663,E0
692664,E0
692665,E0
692666,E0
692667,E0
692668,E0
692669,E986
692670,E3631
692671,E4095
692672,E4095
692673,E4095
692674,E4095
692675,E4095
692676,E4095
692677,E4095
692678,E4095
692679,E2998
692680,E793
692681,E0
692682,E0
692683,E0
692684,E0
692685,E0
692686,E0
692687,E0
692688,E0
692689,E892
692690,E3473
692691,E4095
692692,E4095
692693,E4095
692694,E4095
692695,E4095
692696,E4095
692697,E4095
692698,E4095
692699,E2739
692700,E562
692701,E0
692702,E0
692703,E0
692704,E0
692705,E0
692706,E0
692707,E0
692708,E0
692709,E854
692710,E3458
692711,E4095
692712,E4095
692713,E4085
692714,E4095
692715,E4095
692716,E4095
692717,E4095
692718,E4095
692719,E2889
692720,E780
692721,E0
692722,E0
692723,E0
692724,E0
692725,E0
692726,E0
692727,E0
692728,E0
692729,E1043
692730,E3833
692731,E4095
692732,E4095
692733,E4095
692734,E4095
692735,E4095
692736,E4095
692737,E4095
692738,E4095
692739,E2941
692740,E752
692741,E0
692742,E0
692743,E0
692744,E0
692745,E0
692746,E0
692747,E0
692748,E0
692749,E892
692750,E3413
692751,E4095
692752,E4095
692753,E4095
692754,E4095
692755,E4095
692756,E4095
692757,E4095
692758,E4095
692759,E2672
692760,E496
692761,E0
692762,E0
692763,E0
692764,E0
692765,E0
692766,E0
692767,E0
692768,E0
692769,E1051
692770,E3792
692771,E4095
692772,E4095
692773,E4095
692774,E4095
692775,E4095
692776,E4095
692777,E4095
692778,E4065
692779,E2757
692780,E618
692781,E0
692782,E0
692783,E0
692784,E0
692785,E0
692786,E0
692787,E0
692788,E0
692789,E2302
692791,E4095
692792,E4095
692793,E4095
692794,E4095
692795,E4095
692796,E4095
692797,E4095
692798,E4095
692799,E2544
692800,E221
692801,E0
692802,E0
692803,E0
692804,E0
692805,E0
692806,E0
692807,E0
692808,E0
692809,E1195
692810,E4095
692811,E4095
692812,E4095
692813,E4095
692814,E4095
692815,E4095
692816,E4095
692817,E4095
692818,E4095
692819,E2685
692820,E464
692821,E0
692822,E0
692823,E0
692824,E0
692825,E0
692826,E0
692827,E0
692828,E0
692829,E1225
692830,E4095
692831,E4095
692832,E4095
692833,E4033
692834,E4095
692835,E4095
692836,E4095
692837,E4095
692838,E4071
692839,E2723
692840,E616
692841,E0
692842,E0
692843,E0
692844,E0
692845,E0
692846,E0
692847,E0
692848,E0
692849,E1474
692850,E4095
692851,E4095
692852,E4095
692853,E4095
692854,E4095
692855,E4095
692856,E4095
692857,E4095
692858,E4075
692859,E2819
692860,E592
692861,E0
692862,E0
692863,E0
692864,E0
692865,E0
692866,E0
692867,E0
692868,E0
692869,E1465
692870,E4095
692871,E4095
692872,E4095
692873,E4083
692874,E4095
692875,E4095
692876,E4095
692877,E4095
692878,E4095
692879,E2739
692880,E496
692881,E0
692882,E0
692883,E0
692884,E0
692885,E0
692886,E0
692887,E0
692888,E0
692889,E1446
692890,E4095
692891,E4095
692892,E4095
692893,E4095
692894,E4095
692895,E4095
692896,E4095
692897,E4095
692898,E4073
692899,E2608
692900,E367
692901,E0
692902,E0
692903,E0
692904,E0
692905,E0
692906,E0
692907,E0
692908,E0
692909,E1534
692910,E4095
692911,E4095
692912,E4095
692913,E4081
692914,E4095
692915,E4095
692916,E4095
692917,E4095
692918,E4095
692919,E2613
692920,E354
692921,E0
692922,E0
692923,E0
692924,E0
692925,E0
692926,E0
692927,E0
692928,E0
692929,E1601
692930,E4095
692931,E4095
692932,E4095
692933,E4095
692934,E4095
692935,E4095
692936,E4095
692937,E4095
692938,E4095
692939,E2569
692940,E409
692941,E0
692942,E0
692943,E0
692944,E0
692945,E0
692946,E0
692947,E0
692948,E0
692949,E1462
692950,E4095
692951,E4095
692952,E4095
692953,E4095
692954,E4095
692955,E4095
692956,E4095
692957,E4095
692958,E4095
692959,E2430
692960,E193
692961,E0
692962,E0
692963,E0
692964,E0
692965,E0
692966,E0
692967,E0
692968,E0
692969,E1386
692970,E4095
692971,E4095
692972,E4095
692973,E4083
692974,E4095
692975,E4095
692976,E4095
692977,E4095
692978,E4058
692979,E2515
692980,E206
692981,E0
692982,E0
692983,E0
692984,E0
692985,E0
692986,E0
692987,E0
692988,E0
692989,E1511
692990,E4095
692991,E4095
692992,E4095
692993,E4095
692994,E4095
692995,E4095
692996,E4095
692997,E4095
692998,E4095
692999,E2320
693000,E0
693001,E0
693002,E0
693003,E0
693004,E0
693005,E0
693006,E0
693007,E0
693008,E0
693009,E1554
693010,E4095
693011,E4095
693012,E4095
693013,E4095
693014,E4095
693015,E4095
693016,E4095
693017,E4095
693018,E4095
693019,E2307
693020,E0
693021,E0
693022,E0
693023,E0
693024,E0
693025,E0
693026,E0
693027,E0
693028,E0
693029,E1774
693030,E4095
693031,E4095
693032,E4095
693033,E4095
693034,E4095
693035,E4095";

$dateString="2021-10-22 04:27:21";
$createdAt = \DateTime::createFromFormat('Y-m-d H:i:s', $dateString);
$createdAt=$createdAt ->format('Y-m-d H:i:s');
echo($createdAt);*/
//creating a statement to insert to database
$sql = "INSERT INTO `ecgdata` (`user_id`,`ecg`, `createdAt`) VALUES ('$user_id','$ecg','$createdAt')";

//if data inserts successfully
if(mysqli_query($conn,$sql)){
//making success response
$response['error'] = false;
$response['message'] = 'ECG Data saved successfully';
}
else{
//if not making failure response
$response['error'] = true;
$response['message'] = "Error: ".$sql." => ".$conn->error;;
}
$conn->close();
}
else{
$response['error'] = true;
$response['message'] = "There is no post request";
}
//displaying the data in json format
echo json_encode($response);